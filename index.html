<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>따사룸 매트견적 계산기</title>
    <link
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect x='8' y='6' width='48' height='52' rx='8' ry='8' fill='%232563eb'/%3E%3Crect x='14' y='12' width='36' height='10' rx='3' fill='%23ffffff' opacity='0.9'/%3E%3Crect x='18' y='28' width='10' height='10' rx='2' fill='%23ffffff'/%3E%3Crect x='36' y='28' width='10' height='10' rx='2' fill='%23ffffff'/%3E%3Crect x='18' y='42' width='10' height='10' rx='2' fill='%23ffffff'/%3E%3Crect x='36' y='42' width='10' height='10' rx='2' fill='%23ffffff'/%3E%3C/svg%3E"
    />
    <link rel="stylesheet" href="./styles.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
  </head>
  <body>
    <main class="container">
      <h1>따사룸 매트견적 계산기</h1>

      <div class="layout-wrapper">
        <!-- 왼쪽: 입력 영역 -->
        <div class="layout-left">
          <section class="card">
            <h2>제품 선택</h2>
            <div class="product-tabs">
              <div class="product-tab-item">
                <button class="product-tab-btn active" data-product="babyRoll">
                  <div class="product-tab-image" style="background-image: url('./images/product_01.jpg')"></div>
                </button>
                <span class="product-tab-label">유아 롤매트</span>
              </div>
              <div class="product-tab-item">
                <button class="product-tab-btn" data-product="petRoll">
                  <div class="product-tab-image" style="background-image: url('./images/product_02.jpg')"></div>
                </button>
                <span class="product-tab-label">애견 롤매트</span>
              </div>
              <div class="product-tab-item">
                <button class="product-tab-btn" data-product="puzzle">
                  <div class="product-tab-image" style="background-image: url('./images/product_03.jpg')"></div>
                </button>
                <span class="product-tab-label">퍼즐매트</span>
              </div>
            </div>
          </section>

          <section class="card">
            <h2>두께 선택</h2>
            <div id="thickness-selector" class="thickness-tabs">
              <!-- 동적으로 생성됨 -->
            </div>
          </section>


          <section class="card">
            <h2>공간 입력</h2>

            <!-- 공간 모드 선택 -->
            <div class="space-mode-selector" style="margin-bottom: 20px;">
              <label style="display: block; margin-bottom: 8px; font-weight: 500;">공간 유형</label>
              <div style="display: flex; gap: 16px;">
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                  <input type="radio" name="space-mode" value="simple" checked id="space-mode-simple">
                  <span>단순공간</span>
                </label>
                <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                  <input type="radio" name="space-mode" value="complex" id="space-mode-complex">
                  <span>복합공간</span>
                </label>
              </div>
            </div>

            <!-- 단순공간 섹션 (기존) -->
            <div id="simple-space-section">
              <div id="spaces-container"></div>

              <div class="button-group">
                <button id="add-space" class="secondary">+ 공간 추가</button>
              </div>
            </div>

            <!-- 복합공간 섹션 (새로 추가) -->
            <div id="complex-space-section" style="display: none;">
              <div style="margin-bottom: 16px; padding: 12px; background: #f8fafc; border-radius: 8px; font-size: 14px; color: #64748b;">
                여러 개의 직사각형 조각을 연결하여 L자, T자 등 복합 형태의 공간을 만들 수 있습니다.
              </div>

              <div id="complex-connectivity-warning" class="complex-warning" style="display: none;">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M10.29 3.86L1.82 18a1 1 0 0 0 .86 1.5h18.64a1 1 0 0 0 .86-1.5L13.71 3.86a1 1 0 0 0-1.72 0z"></path>
                  <line x1="12" y1="9" x2="12" y2="13"></line>
                  <line x1="12" y1="17" x2="12.01" y2="17"></line>
                </svg>
                <div>
                  <strong>조각 연결이 필요합니다</strong>
                  <span>복합공간의 모든 조각은 서로 맞닿아 있어야 합니다. 좌표를 다시 조정해주세요.</span>
                </div>
              </div>

                <div class="template-selector">
                  <div class="template-selector__header">
                    <div>
                      <div class="template-selector__title">빠른 템플릿</div>
                      <div class="template-selector__desc">자주 상담되는 복합 공간 형태를 바로 불러올 수 있습니다.</div>
                  </div>
                  <small class="template-selector__hint">불러온 후 가로·세로 / 좌표를 자유롭게 수정하세요.</small>
                </div>
                <div class="template-grid" id="complex-template-buttons">
                  <!-- 템플릿 버튼이 JS로 동적 생성됩니다 -->
                </div>
              </div>

              <!-- 조각 목록 -->
              <div id="pieces-container">
                <!-- 조각들이 동적으로 추가됨 -->
              </div>

              <div class="button-group">
                <button id="add-piece" class="secondary">+ 조각 추가</button>
              </div>
            </div>
          </section>
        </div>

        <!-- 오른쪽: 견적 결과 -->
        <div class="layout-right">
          <section class="card">
            <h2>견적 결과</h2>

            <div class="result">
              <div style="margin-bottom: 12px;"><strong>총 구성</strong></div>
              <div id="total-composition" style="margin-left: 20px; margin-bottom: 12px;">-</div>
              <div style="margin-top: 16px;"><strong>총 수량 및 가격</strong></div>
              <div id="total-summary" style="margin-left: 20px;">-</div>
            </div>

            <div class="action-buttons">
              <button id="copy-estimate" class="action-btn secondary-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                  <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                </svg>
                견적 복사
              </button>
              <a id="purchase-link" href="#" target="_blank" class="action-btn primary-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="9" cy="21" r="1"></circle>
                  <circle cx="20" cy="21" r="1"></circle>
                  <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                제품 구매하기
              </a>
            </div>
          </section>
        </div>
      </div>

      <footer class="muted small" style="text-align: center; padding: 20px 0; line-height: 1.6;">
        <strong style="color: #475569;">따사룸 (주)대승아이앤피</strong> 공식 견적 계산기<br>
        개발 관리: 천승엽 팀장 | 무단 복제 및 도용 시 법적 조치 가능
      </footer>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="./js/constants.js"></script>
    <script src="./js/prices.js"></script>
    <script src="./js/utils.js"></script>
    <script src="./js/calculations.js"></script>
    <script src="./js/visualization.js"></script>
    <script src="./app.js"></script>
  </body>
  </html>
